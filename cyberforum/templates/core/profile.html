{% extends 'base.html' %}
{% load widget_tweaks %}
{% block content %}
<h2>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
<div class="alert alert-info">
    –ü—Ä–∏–≤–µ—Ç, <strong>{{ user.email }}</strong>!
</div>
{% if not user.first_name or not user.last_name %}
  <div class="alert alert-warning">
    <strong>–í–Ω–∏–º–∞–Ω–∏–µ!</strong> –£–∫–∞–∂–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é, —á—Ç–æ–±—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –∫—É—Ä—Å–æ–≤.
  </div>
{% endif %}

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="card mb-4">
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="card mb-4">
        <div class="card-header bg-success text-white">
            <h5 class="mb-0">–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
        </div>
        <div class="card-body">
            <p><strong>–ü—Ä–æ–π–¥–µ–Ω–æ –∫—É—Ä—Å–æ–≤:</strong> {{ completed_courses_count }}</p>
            <p><strong>–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤:</strong> {{ total_tests }}</p>
            <p><strong>–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong> {{ avg_percent }}%</p>
        </div>
    </div>
    <div class="card mb-4">
    <div class="card-header bg-info text-white">
        <h5 class="mb-0">–ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ –∫—É—Ä—Å—ã</h5>
    </div>
    <div class="card-body">
         <!-- –í –±–ª–æ–∫–µ "–ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ –∫—É—Ä—Å—ã" -->
    {% if completed_courses %}
    <ul class="list-group list-group-flush">
       {% for cc in completed_courses %}
          <li class="list-group-item">
            {{ cc.course.title }} ‚Äî {{ cc.completed_at|date:"d.m.Y" }}
            {% if user.first_name and user.last_name %}
              <a href="{% url 'courses:download_certificate' cc.course.id %}" class="btn btn-sm btn-outline-success float-end">
                üìÑ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
              </a>
            {% else %}
              <span class="text-muted float-end">üìÑ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å)</span>
            {% endif %}
          </li>
        {% endfor %}
    </ul>
{% endif %}
    </div>
</div>
</div>

<!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
<div class="row">
  <div class="col-lg-6">
    <form method="post">
    {% csrf_token %}
    {% for field in form %}
        <div class="mb-3">
            {{ field.label_tag }}
            {{ field }}
            {% if field.help_text %}
                <small class="form-text text-muted">{{ field.help_text }}</small>
            {% endif %}
        </div>
    {% endfor %}
    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
</form>
  </div>
</div>
<hr>
<a href="{% url 'core:logout' %}" class="btn btn-outline-danger">–í—ã–π—Ç–∏</a>
{% endblock %}